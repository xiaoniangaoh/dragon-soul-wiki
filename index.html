<!DOCTYPE html>
<html>
<head>
    <title>dragon soul 龙魂中文 Wiki - 社区</title> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <style>
        body {
            background-image: url('background.jpg'); /* 替换为你的背景图片URL */
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
            font-family: sans-serif;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column; /* 改为垂直布局 */
            align-items: center;
            min-height: 100vh;
        }

        .hero-section {
            background-color: rgba(0, 123, 255, 0.9); /* Hero 区背景色， 蓝色 */
            color: white;
            text-align: center;
            padding: 50px 20px; /* Hero 区 padding 更大 */
            margin-bottom: 20px; /* Hero 区底部 margin */
            border-radius: 15px 15px 0 0; /* Hero 区顶部圆角 */
            width: 100%; /* Hero 区宽度 100% */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); /* Hero 区阴影 */
        }

        .hero-section h1 {
            font-size: 2.5em; /* Hero 区标题更大 */
            margin-bottom: 10px;
            color: white; /* Hero 区标题颜色改为白色 */
            text-shadow: 2px 2px 4px #000000; /* 添加文字阴影， 突出标题 */
        }

        .hero-section p {
            font-size: 1.2em; /* Hero 区宣传语字体 */
            font-weight: bold;
        }


        .container {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px; /* 统一圆角 */
            padding: 20px;
            margin: 10px; /* 容器上下左右 margin */
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            text-align: left;
            max-width: 95%;
            width: auto; /* 宽度自适应 */
        }

        h1 {
            text-align: center;
            color: #007bff;
            font-size: 2em;
        }

        ol {
            list-style-type: none;
            padding: 0;
            text-align: center;
            margin-bottom: 20px; /* 菜单底部增加 margin */
        }

        ol li {
            display: inline;
            margin: 0 15px; /* 菜单项 margin 稍微大一点 */
        }

        ol li a {
            text-decoration: none;
            color: #007bff;
            font-weight: bold;
            font-size: 1.1em; /* 菜单链接字体稍微大一点 */
        }

        ol li a:hover {
            color: #0056b3;
        }

        hr {
            border: 0;
            border-top: 2px solid #ccc;
            margin: 15px 0;
        }

        section {
            margin-bottom: 25px;
        }

        h2 {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
            font-size: 1.5em;
            margin-bottom: 15px; /* 增加 h2 底部 margin */
        }

        h3 {
            color: #007bff;
            margin-top: 15px;
            font-size: 1.2em;
        }

        ul, ol {
            padding-left: 25px;
        }

        ul li, ol li {
            font-size: 1em;
            margin-bottom: 5px;
        }


        p {
            font-size: 1em;
            line-height: 1.6;
        }


        a {
            color: #007bff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .qq-share-image {
            max-width: 80%;
            height: auto;
            display: block;
            margin: 10px auto;
        }

        #qqqun p,
        #qqpindao p {
            text-align: center;
        }

        b {
            color: #007bff;
        }

        /* 特色内容展示区样式 */
        .featured-content {
            display: flex;
            flex-wrap: wrap; /* 允许卡片换行 */
            justify-content: center; /* 水平居中 */
            margin-bottom: 20px; /* 底部 margin */
        }

        .feature-card {
            background-color: rgba(255, 255, 255, 0.9); /* 卡片背景色 */
            border-radius: 10px;
            padding: 20px;
            margin: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2); /* 卡片阴影 */
            text-align: center;
            width: 250px; /* 卡片宽度 */
            transition: transform 0.3s ease; /* 添加过渡效果 */
        }

        .feature-card:hover {
            transform: translateY(-5px); /* 鼠标悬浮时卡片向上移动 */
        }

        .feature-card h3 {
            color: #007bff;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.3em; /* 卡片标题字体 */
        }

        .feature-card p {
            font-size: 0.95em; /* 卡片描述字体 */
            color: #666;
        }

        .feature-card a {
            display: block; /* 让链接占满整个卡片 */
            text-decoration: none;
            color: inherit; /* 继承卡片的文字颜色 */
        }

        .feature-card img {
            max-width: 80px; /* 卡片图标大小 */
            height: auto;
            margin-bottom: 10px;
        }

        /* 新增的帖子列表和发帖表单样式 */
        #posts-section, #new-post-section {
             margin-top: 20px;
             width: 95%; /* 宽度与 .container 保持一致 */
             max-width: 95%;
        }

        #new-post-form div {
            margin-bottom: 15px;
        }

        #new-post-form label {
            display: block; /* 让 label 独占一行 */
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        #new-post-form input[type="text"],
        #new-post-form textarea {
            width: calc(100% - 22px); /* 减去 padding 和 border */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            box-sizing: border-box; /* 确保 padding 和 border 不会增加元素总宽度 */
        }

        #new-post-form button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #new-post-form button:hover {
            background-color: #0056b3;
        }

        /* 帖子列表样式 (示例，你需要根据实际帖子结构调整) */
        .post-item {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .post-item h3 {
            margin-top: 0;
            color: #0056b3; /* 帖子标题颜色 */
        }

        .post-item p {
            color: #555;
            line-height: 1.5;
            word-break: break-word; /* 防止长单词或URL溢出 */
        }

        .post-meta {
            font-size: 0.9em;
            color: #777;
            margin-top: 10px;
        }


        /* 媒体查询， 针对小屏幕优化 */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px; /* 小屏幕下保留 margin */
            }

            h1 {
                font-size: 1.8em;
            }

            ol li {
                margin: 0 8px;
            }

            ol li a {
                font-size: 0.9em;
            }

            h2 {
                font-size: 1.3em;
            }

            h3 {
                font-size: 1.1em;
            }

            ul, ol {
                padding-left: 20px;
            }

            ul li, ol li, p {
                font-size: 0.95em;
            }

            .qq-share-image {
                max-width: 150px;
            }

            .hero-section {
                padding: 30px 15px; /* 小屏幕下 Hero 区 padding 小一点 */
            }

            .hero-section h1 {
                font-size: 2em; /* 小屏幕下 Hero 区标题字体小一点 */
            }

            .hero-section p {
                font-size: 1em; /* 小屏幕下 Hero 区宣传语字体小一点 */
            }

            .feature-card {
                width: 100%; /* 小屏幕下卡片宽度 100% 占满一行 */
                margin: 10px 0; /* 小屏幕下卡片上下 margin */
            }

            #posts-section, #new-post-section {
                 width: 100%; /* 小屏幕下宽度 100% */
                 max-width: 100%;
                 margin: 10px 0; /* 小屏幕下上下 margin */
                 padding: 15px; /* 小屏幕下 padding */
                 box-sizing: border-box; /* 确保 padding 不会增加总宽度 */
            }

             #new-post-form input[type="text"],
             #new-post-form textarea {
                 width: calc(100% - 20px); /* 调整宽度计算 */
                 padding: 10px;
             }
        }
    </style>
</head>
<body>
    <div class="hero-section">
        <h1>dragon soul 龙魂中文 Wiki</h1>
        <p>欢迎来到龙魂社区！在这里分享你的游戏心得和交流！</p>
    </div>

    <div class="container">
        <ol>
            <li><a href="guanghuan.html">光环 (AURA)</a></li>
            <li><a href="dengji.html">等级 (Level)</a></li>
            <li><a href="boss.html">Boss</a></li>
            <li><a href="suipian.html">碎片 (Fragment)</a></li>
            <li><a href="linghun.html">灵魂 (Soul)</a></li>
            <li><a href="zhanli.html">战力 (Combat Power)</a></li>
            <li><a href="tongxingzheng.html">通行证 (Battle Pass)</a></li>
            <li><a href="qqqun.html">QQ群分享 (QQ Group)</a></li>
            <li><a href="qqpindao.html">QQ频道分享 (QQ Channel)</a></li>
        </ol>

        <hr>

        <section class="featured-content">
            <div class="feature-card">
                <a href="boss.html">
                    <img src="boss_icon.png" onerror="this.onerror=null; this.src='https://placehold.co/80x80/007bff/ffffff?text=Boss';" alt="Boss 攻略图标"> <h3>最新 Boss 攻略</h3>
                    <p>掌握最新 Boss 打法， 轻松通关高难度副本！</p>
                </a>
            </div>

            <div class="feature-card">
                <a href="dengji.html">
                    <img src="level_icon.png" onerror="this.onerror=null; this.src='https://placehold.co/80x80/007bff/ffffff?text=Level';" alt="等级提升图标"> <h3>等级快速提升指南</h3>
                    <p>还在升级慢？ 这里有快速升级的秘诀！</p>
                </a>
            </div>

            <div class="feature-card">
                <a href="suipian.html">
                    <img src="fragment_icon.png" onerror="this.onerror=null; this.src='https://placehold.co/80x80/007bff/ffffff?text=Fragment';" alt="碎片攻略图标"> <h3>彩色碎片获取攻略</h3>
                    <p>彩色碎片哪里刷？ 最全攻略都在这里！</p>
                </a>
            </div>

            <div class="feature-card">
                <a href="linghun.html">
                    <img src="soul_icon.png" onerror="this.onerror=null; this.src='https://placehold.co/80x80/007bff/ffffff?text=Soul';" alt="灵魂系统图标"> <h3>灵魂系统深度解析</h3>
                    <p>灵魂系统怎么玩？ 看完你就明白了！</p>
                </a>
            </div>
        </section>
    </div>

    <div class="container" id="posts-section">
        <h2>社区帖子</h2>
        <div id="posts-list">
            <p>正在加载帖子...</p>
        </div>
    </div>

    <hr> <div class="container" id="new-post-section">
        <h2>发布新帖子</h2>
        <form id="new-post-form">
            <div>
                <label for="post-title">标题:</label>
                <input type="text" id="post-title" name="title" required>
            </div>
            <div>
                <label for="post-content">内容:</label>
                <textarea id="post-content" name="content" rows="10" required></textarea>
            </div>
            <button type="submit">发布</button>
        </form>
    </div>

    <script>
        // 你的 Cloudflare Worker URL
        const WORKER_URL = 'super-art-fa2a.xiaoniangaoh.workers.dev'; // 替换成你的实际 Worker URL

        document.addEventListener('DOMContentLoaded', () => {
            // 加载帖子函数
            async function loadPosts() {
                const postsListDiv = document.getElementById('posts-list');
                postsListDiv.innerHTML = '<p>正在加载帖子...</p>'; // 显示加载状态

                try {
                    // 向 Worker 发送 GET 请求获取帖子列表
                    const response = await fetch(`${WORKER_URL}/api/posts`);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const posts = await response.json();

                    postsListDiv.innerHTML = ''; // 清空加载状态

                    if (posts.length === 0) {
                        postsListDiv.innerHTML = '<p>还没有帖子，快来发布第一篇吧！</p>';
                    } else {
                        posts.forEach(post => {
                            const postElement = document.createElement('div');
                            postElement.classList.add('post-item');
                            // 注意：这里假设你的帖子对象有 id, title, content, created_at 属性
                            postElement.innerHTML = `
                                <h3>${post.title}</h3>
                                <p>${post.content}</p>
                                <div class="post-meta">发布时间: ${new Date(post.created_at).toLocaleString()}</div>
                            `;
                            postsListDiv.appendChild(postElement);
                        });
                    }

                } catch (error) {
                    console.error('加载帖子失败:', error);
                    postsListDiv.innerHTML = '<p>加载帖子失败，请稍后再试。</p>';
                }
            }

            // 提交新帖子函数
            const newPostForm = document.getElementById('new-post-form');
            newPostForm.addEventListener('submit', async (event) => {
                event.preventDefault(); // 阻止表单默认提交

                const titleInput = document.getElementById('post-title');
                const contentInput = document.getElementById('post-content');

                const newPost = {
                    title: titleInput.value,
                    content: contentInput.value
                };

                try {
                    // 向 Worker 发送 POST 请求发布新帖子
                    const response = await fetch(`${WORKER_URL}/api/posts`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(newPost)
                    });

                    if (!response.ok) {
                         // 尝试读取错误信息
                        const errorText = await response.text();
                        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                    }

                    // 帖子发布成功，可以清空表单并重新加载帖子列表
                    titleInput.value = '';
                    contentInput.value = '';
                    alert('帖子发布成功！'); // 可以替换成更友好的提示方式
                    loadPosts(); // 重新加载帖子列表以显示新帖子

                } catch (error) {
                    console.error('发布帖子失败:', error);
                    alert(`发布帖子失败：${error.message}`); // 显示具体的错误信息
                }
            });

            // 页面加载完成后立即加载帖子
            loadPosts();
        });

    </script>
</body>
</html>
